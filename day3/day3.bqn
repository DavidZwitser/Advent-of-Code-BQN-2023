f â† >â€¢file.Lines "data.txt"
t â† f

GroupNeighbours â† (Â¬-ËœâŠ¢Ã—Â·+`Â»âŠ¸>)âŠ¸âŠ”
IsNmbr 			â† â‰¥âŸœ'0'âˆ§â‰¤âŸœ'9'
IsSymbol 		â† â‰ âŸœ' ' âˆ§ Â¬âˆ˜IsNmbr âˆ§ â‰ âŸœ'.'
Snip 			â† {[start,end]ğ•Šarr: start â†“ (end+1) â†‘ arr}
Indc 			â† /â—‹â¥ŠâŸœ(â†•â‰¢) # Get the indicies

boxes â† âˆ¾â¥Š(â†•â‰ t) {
	ğ•¨âŠ¸â‰Ë˜Â¨ (âŠ‘â‰(âŠ‘âŒ½))Â¨ GroupNeighboursâŸœ(â†•â‰ ) IsNmbr ğ•©
}Â¨ â‹ˆË˜ t

Nmbrs â† tâŠ¸{
	valid 	â† +Â´+Â´Ë˜ IsSymbol area â† (0 âŒˆ Â¯1â€¿1 + ğ•©) Snip ğ•¨
	nmbr 	â† valid Ã— â€¢ParseFloat âŠ ğ•© Snip ğ•¨
}
pt1 â† +Â´ NmbrsÂ¨ boxes

ValsWithStars â† {â‰¢âŸœ@Â¨âŠ¸/ tâŠ¸{
	cutout 	â† 0 âŒˆ Â¯1â€¿1 + ğ•©
	valid 	â† +Â´+Â´Ë˜ IsSymbol area â† cutout Snip ğ•¨
	nmbr 	â† valid Ã— â€¢ParseFloat âŠ ğ•© Snip ğ•¨
	stars 	â† (âŠcutout)âŠ¸+Â¨ Indc '*' = area

	{0<â‰ stars ? nmbrâ€¿stars ; @}
}Â¨ ğ•©}

MultiplyMatchingStars â† {
	match_matrix 	â† (âˆ¨Â´âˆ¨Ë)âˆ˜(â‰¡âŒœ)â—‹(1âŠ¸âŠ‘)âŒœËœğ•©
	indicies 		â† <Â´Â¨âŠ¸/ /â—‹â¥ŠâŸœ(â†•â‰¢) match_matrix
	values 			â† âŠ‘Â¨Â¨ âŠ‘âŸœğ•©âš‡0 indicies
	multiplications â† >Ã—ËÂ¨ values
}

pt2 â† +Â´ MultiplyMatchingStars ValsWithStars boxes
